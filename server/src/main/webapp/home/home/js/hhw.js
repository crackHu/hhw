var authorization,gen_msg_loading,gen_parking_detail,gen_parking_list_item,gen_user_cars,get_token,query_order_List,query_parking_detail,query_parking_list,query_user;query_user=function(a){var b,c;return c=get_token(),b={token:c},$.ajax({type:"GET",url:"/hhw/v2/user/getUserInfoByToken",data:b,dataType:"json",cache:!1,success:function(b){if(b&&b.data&&a)return a(b.data)},error:function(a){return console.log("Error Derail:",a)}})},query_parking_list=function(){var a,b,c,d;return d=get_token(),b=gen_msg_loading(),a=$("#loadingToast"),a.fadeIn(100),c={token:d},$.ajax({type:"GET",url:"/hhw/v2/other/otherparksite/getParkingListByPage",data:c,dataType:"json",cache:!1,success:function(a){if(console.log(a),b.destroy(),a&&a.data)return a.data.content.map(function(a,b){return gen_parking_list_item(a)})},error:function(a){return b.destroy(),console.log("Error Derail:",a)}})},authorization=function(){var a,b,c;return a=$.getUrlParam("code"),b=gen_msg_loading(),a?(c={code:a},$.ajax({type:"GET",url:"/hhw/v2/open/wechat/getWechatUser",data:c,dataType:"json",cache:!1,success:function(a){return b.destroy(),a&&a.data?($.cookie("hhw_token",a.data.token),location.href="index.html"):location.href=_authorizationLink},error:function(a){return b.destroy(),console.log("Error Derail:",a)}})):location.href=_authorizationLink},query_parking_detail=function(){var a,b,c,d;return d=get_token(),a=gen_msg_loading(),c=$.getUrlParam("pid"),b={token:d,id:c},$.ajax({type:"GET",url:"/hhw/v2/other/otherparksite/getParkingById",data:b,dataType:"json",cache:!1,success:function(b){if(console.log(b),a.destroy(),b&&b.data)return gen_parking_detail(b.data)},error:function(b){return a.destroy(),console.log("Error Derail:",b)}})},gen_parking_list_item=function(a){var b,c;return c=$(".weui-cells"),b='<a class="weui-cell weui-cell_access" href="parking.html?pid='+a.otId+'"><div class="weui-cell__hd"><img class="p_logo" src="../images/p.svg" alt=""/></div><div class="weui-cell__bd base_info"><div class="title"><span>'+a.otName+'</span></div><div class="desc"><span>车位：'+a.otReleaseRes+"</span><span>¥"+a.otPrice+'/小时</span></div></div><div class="weui-cell__ft '+(a.otFreeRes<=1?"red":"")+'">剩余：'+a.otFreeRes+"</div></a>",c.append(b)},gen_parking_detail=function(a){var b,c;return b=$(".park_image"),a.images.length&&b.append('<img src="'+a.images[0].otUrl+'" alt=""/>'),c=$(".park_info"),c.append('<div class="weui-cell"><div class="weui-cell__bd base_info"><div class="title"><span>'+a.otName+'</span></div><div class="desc"><span>车位：'+a.otReleaseRes+"</span><span>¥"+a.otPrice+'/小时</span></div></div><div class="weui-cell__ft park_info '+(a.otFreeRes<=1?"red":"")+'">剩余：'+a.otFreeRes+'</div></div><div class="weui-cell weui-cell_access js_item"><div class="weui-cell__hd address"><i class="icon icon-location"/></div><div class="weui-cell__bd address">'+a.otAddress+'</div><div class="weui-cell__ft"></div></div>'),query_user(gen_user_cars)},gen_user_cars=function(a){var b,c;if(c=a.cars,b=$(".cars"),c.map(function(a){return b.append('<label class="weui-cell weui-check__label" for="car_'+a.otCarId+'"><div class="weui-cell__bd"><p>'+[a.otCarProvince,a.otCarCity," ",a.otCarNum].join("")+'</p></div><div class="weui-cell__ft"><input type="radio" name="cars" class="weui-check" id="car_'+a.otCarId+'"><span class="weui-icon-checked"></span></div></label>')}),a.cars.length<5)return b.append('<a href="javascript:void(0);" class="weui-cell weui-cell_link"><div class="weui-cell__bd"><i class="icon icon-add"/>添加车辆</div></a>')},get_token=function(){var a;return a=$.cookie("hhw_token"),a?a:(location.href="code.html",null)},gen_msg_loading=function(){return new $.MsgBox("努力加载中...",2)},query_order_List=function(){var a,b,c;return c=get_token(),a=gen_msg_loading(),b={token:c},$.ajax({type:"POST",url:"/hhw/v2/order/getOrderListByToken",data:b,dataType:"json",cache:!1,success:function(a){return console.log(a),console.log("haha")},error:function(b){return a.destroy(),console.log("Error Derail:",b)}})},$(document).on("touchstart","dd.key",function(a){var b;if(a.preventDefault(),b=$(this),!b.hasClass("disable"))return b.addClass("active")}),$(document).on("touchend","dd.key",function(a){var b;if(a.preventDefault(),b=$(this),!b.hasClass("disable"))return b.removeClass("active"),alert(b.attr("value"))});var _authorizationLink;_authorizationLink="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx219c336fa191f482&redirect_uri=http%3A%2F%2Fdev.basoft.cn%2Fhhw%2Fhome%2Fcode.html&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect",$.MsgBox=function(a,b,c){var d,e;if(null==b&&(b=1),null==c&&(c=0),e=this,d=$(".msgBox_"+b),e.init=function(){var c;if(0===$(".msgBox_"+b).length)return c='<div class="msgBox_'+b+'" style="display: none"><div class="mask_transparent"></div><div class="weui-toast"><i class="weui-icon_toast '+(2===b?"weui-loading":"weui-icon-success-no-circle")+'"/><p class="weui-toast__content">'+a+"</p></div></div>",$("body").append(c),d=$(".msgBox_"+b)},e.show=function(){return d.fadeIn(100)},e.hide=function(){return d.fadeOut(100)},e.destroy=function(){return d.fadeOut(100),setTimeout(function(){return d.remove()},200)},e.init(a,b),e.show(),c>0)return setTimeout(function(){return e.hide(),e.destroy()},c)},$.getUrlParam=function(a){var b,c;return c=new RegExp("(^|&)"+a+"=([^&]*)(&|$)"),b=window.location.search.substr(1).match(c),null!==b?unescape(b[2]):null},$(document).on("touchend","div.back_button",function(a){return a.preventDefault(),history.go(-1)});